<my-pro-page-header-wrapper>
  <nz-layout>
    <nz-content>
      <nz-card [nzBordered]="false">
        <div class="edit-button-div">
          <button nz-button  class="img-filtrate" nzShape="round"  (click)="openDrawer()">筛选</button>
        </div>
        <ng-template #totalTemplate let-total> 共 {{ total }} 条 </ng-template>
        <nz-table #headerTable
                  nzShowSizeChanger
                  nzBordered
                  [nzFrontPagination]="false"
                  [nzData]="list"
                  [nzLoading]="loading"
                  [nzTotal]="page.total"
                  [(nzPageIndex)]="page.pageNum"
                  [(nzPageSize)]="page.pageSize"
                  [nzShowTotal]="totalTemplate"
                  (nzPageIndexChange)="queryUserList()"
                  (nzPageSizeChange)="queryUserList(true)">
          <thead>
          <tr>
            <th style="width: 50px">序号</th>
            <th>用户</th>
            <th>手机号</th>
            <th>昵称</th>
            <th>企业</th>
            <th>性别</th>
            <th>国家</th>
            <th>省</th>
            <th>市</th>
            <th>区</th>
            <th>状态</th>
            <th>注册时间</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let data of headerTable.data;let index = index"
              style="cursor: pointer" (click)="toDetail(data.userId)">
            <td>{{ page.getNo(index) }}</td>
            <td>{{ data.userName }}</td>
            <td>{{ data.mobile }}</td>
            <td>{{ data.nickname }}</td>
            <td>{{ data.corpName }}</td>
            <td *ngIf=" data.sex =='1'">男</td>
            <td *ngIf=" data.sex =='2'">女</td>
            <td *ngIf=" data.sex ==''"></td>
            <td>{{ data.country }}</td>
            <td>{{ data.provinceName }}</td>
            <td>{{ data.cityName }}</td>
            <td>{{ data.districtName }}</td>
            <td *ngIf=" data.status =='1'">正常</td>
            <td *ngIf=" data.status =='2'">失效</td>
            <td *ngIf=" data.status ==null"></td>
            <td>{{ data.regTime | date:'yyyy-MM-dd HH:mm'}}</td>
          </tr>
          </tbody>
        </nz-table>
      </nz-card>
    </nz-content>

    <!-----------------------------------用户筛选-------------------------------------------------->
    <ng-template #filterTitle>
      <img src="assets/go-back.svg" (click)="closeDrawer()" style="padding-right: 20px;">
      <span style="font-size: 16px;font-weight: bold;">用户筛选</span>
    </ng-template>

    <nz-drawer [nzTitle]="filterTitle" [nzVisible]="drawerVisible" [nzWidth]="500" [nzClosable]="false"
               (nzOnClose)="closeDrawer()"
               [nzBodyStyle]="{ height: 'calc(100% - 55px)', overflow: 'auto', 'padding-bottom': '53px' }">
      <form nz-form [formGroup]="searchForm">
        <nz-form-item>
          <nz-form-label nzFor="roleName" [nzSpan]="6">企业名称</nz-form-label>
          <nz-form-control [nzSpan]="16">
            <nz-select
              nzShowSearch
              nzServerSearch
              nzAllowClear="true"
              nzPlaceHolder="请输入企业名称"
              [nzFilterOption]="nzFilterOption"
              (nzOnSearch)="matchCorp($event)"
              (ngModelChange)="corpChange($event)"
              formControlName="corpId">
              <nz-option *ngFor="let o of corpList" [nzLabel]="o.text" [nzValue]="o.value"></nz-option>
              <nz-option *ngIf="corpLoading" nzDisabled nzCustomContent>
                <i nz-icon nzType="loading" class="loading-icon"></i> 加载数据中
              </nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSpan]="6">用户名称</nz-form-label>
          <nz-form-control [nzSpan]="16">
            <nz-select [nzAllowClear]="true"
                       formControlName="userId"
                       nzShowSearch
                       nzServerSearch
                       (nzOnSearch)="matchUser($event)"
                       nzPlaceHolder="根据姓名、手机号搜索">
              <nz-option *ngFor="let option of userIdList" [nzValue]="option.value"
                         [nzLabel]="option.text"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSpan]="6">手机号</nz-form-label>
          <nz-form-control [nzSpan]="16">
            <input type="text" nz-input formControlName="mobile" placeholder="请输入手机号" />
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSpan]="6">昵称</nz-form-label>
          <nz-form-control [nzSpan]="16">
            <input type="text" nz-input formControlName="nickname" placeholder="请输入昵称" />
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSpan]="6">性别</nz-form-label>
          <nz-form-control [nzSpan]="16">
            <nz-radio-group formControlName="sex" nzPlaceHolder="请选择性别">
              <label nz-radio nzValue="">不限</label>
              <label nz-radio nzValue="1">男</label>
              <label nz-radio nzValue="2">女</label>
            </nz-radio-group>
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSpan]="6">国家</nz-form-label>
          <nz-form-control [nzSpan]="16">
            <input type="text" nz-input formControlName="country" placeholder="请输入国家" />
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSpan]="6">行政区划</nz-form-label>
          <nz-form-control  [nzSpan]="16">
            <nz-cascader
              nzPlaceHolder="请选择行政区划"
              formControlName="area"
              [nzChangeOnSelect]="true"
              [nzAllowClear]="true"
              [nzOptions]="areaInfoOption" [nzShowSearch]="ZorroUtils.showSearchOptions"
              (ngModelChange)="areaChange($event)">
            </nz-cascader>
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSpan]="6">状态</nz-form-label>
          <nz-form-control [nzSpan]="16">
            <nz-radio-group formControlName="status" nzPlaceHolder="请选择状态">
              <label nz-radio nzValue="">不限</label>
              <label nz-radio nzValue="1">正常</label>
              <label nz-radio nzValue="2">失效</label>
            </nz-radio-group>
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSpan]="6">注册时间</nz-form-label>
          <nz-form-control [nzSpan]="16">
            <nz-range-picker formControlName="regTime" [nzFormat]="'yyyy-MM-dd'"  ></nz-range-picker>
          </nz-form-control>
        </nz-form-item>
        <div style="text-align: right;margin-top: 40px">
          <button class="ant-btn" style="margin-left: 8px;margin-right: 10px;" nz-button (click)="clearDrawer();"><span>清空筛选</span>
          </button>
          <button nz-button [nzType]="'primary'" (click)="closeDrawer();queryUserList(true)">查询</button>
        </div>
      </form>
    </nz-drawer>
  </nz-layout>
</my-pro-page-header-wrapper>
