<nz-content>
  <form nz-form [formGroup]="validateForm" (ngSubmit)="submitForm(validateForm.value)">
    <nz-form-item>
      <nz-form-label [nzSpan]="4" nzRequired>分类名称</nz-form-label>
      <nz-form-control [nzSpan]="16" nzHasFeedback>
        <input nz-input formControlName="name" placeholder="请输入分类名称">
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSpan]="4" nzRequired>父分类名称</nz-form-label>
      <nz-form-control [nzSpan]="16" nzHasFeedback>
        <nz-select nz-input formControlName="parentId" nzPlaceHolder="请选择父分类名称">
          <nz-option *ngFor="let data of catalogInfoList" [nzLabel]="data.name" [nzValue]="data.id"></nz-option>
        </nz-select>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSpan]="4">图片</nz-form-label>
      <nz-form-control [nzSpan]="16" nzHasFeedback>
        <nz-upload
          nzListType="picture-card"
          [(nzFileList)]="fileList"
          [nzBeforeUpload]="beforeUpload"
          [nzAction]="uploadAction"
          (nzChange)="handleChange($event)"
          [nzShowButton]="fileList.length < 1"
          [nzRemove]="removeFile"
          [nzPreview]="handlePreview"
        >
          <i class="upload-icon" nz-icon [nzType]="loading ? 'loading' : 'plus'"></i>
          <div class="ant-upload-text">Upload</div>
        </nz-upload>
        <nz-modal
          [nzVisible]="previewVisible"
          [nzContent]="modalContent"
          [nzFooter]="null"
          (nzOnCancel)="previewVisible = false"
        >
          <ng-template #modalContent>
            <img [src]="previewImage" [ngStyle]="{ width: '100%' }"/>
          </ng-template>
        </nz-modal>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSpan]="4">描述</nz-form-label>
      <nz-form-control [nzSpan]="16" nzHasFeedback>
        <textarea nz-input formControlName="description" placeholder="请输入描述" [nzAutosize]="{minRows: 2,maxRows: 5}"></textarea>
      </nz-form-control>
    </nz-form-item>
    <div *ngFor="let item of paramList;let index = index">
      <nz-form-item>
        <nz-form-label [nzSpan]="4" nzRequired>常用可选规格参数</nz-form-label>
        <nz-form-control [nzSpan]="2" nzHasFeedback [nzErrorTip]="valueErrorTpl">
          <input formControlName="{{item.id}}" [(ngModel)]="item.attribute" maxlength="5" nz-input placeholder="参数" style="width: 100px;"/>
          <ng-template #valueErrorTpl let-control>
            <ng-container *ngIf="control.hasError('required')">
              填入分数
            </ng-container>
            <ng-container *ngIf="control.hasError('maxlength')">
              不能超过5位数！
            </ng-container>
          </ng-template>
        </nz-form-control>

        <nz-form-label [nzSpan]="4" nzRequired>规格值</nz-form-label>
        <nz-form-control [nzSpan]="5" nzHasFeedback [nzErrorTip]="valueErrorTpl">
          <input   [ngModelOptions]="{standalone: true}"  [(ngModel)]="item.value" nz-input  maxlength="100" style="width: 150px;" placeholder="规格值" />
        </nz-form-control>

        <button type="button"  *ngIf="!item.canDelete"  nz-button [nzType]="'primary'" (click)="addParamItem()" >
          <i nz-icon nzType="plus-circle"></i>
        </button>

        <button type="button"  *ngIf="item.canDelete" nz-button [nzType]="'primary'"  (click)="removeParamItem(item,index)" >
          <i nz-icon nzType="minus-circle" nzTheme="outline"></i>
        </button>
      </nz-form-item>
    </div>
    <nz-form-item>
      <nz-form-label [nzSpan]="4" nzRequired>顺序号</nz-form-label>
      <nz-form-control [nzSpan]="16" nzHasFeedback>
        <nz-input-number nz-input formControlName="sortNo" nzPlaceHolder="" [nzMin]="0"></nz-input-number>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSpan]="4">是否可用</nz-form-label>
      <nz-form-control [nzSpan]="16" nzHasFeedback>
        <nz-switch formControlName="enabled" nzCheckedChildren="启用" nzUnCheckedChildren="禁用" [(ngModel)]="enabledValue"></nz-switch>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-control [nzOffset]="10" [nzSpan]="12">
        <button nz-button nzType="primary" [disabled]="!validateForm.valid">提交</button>&nbsp;
        <button nz-button type="button" (click)="destroyModal()">取消</button>
      </nz-form-control>
    </nz-form-item>
  </form>
</nz-content>
