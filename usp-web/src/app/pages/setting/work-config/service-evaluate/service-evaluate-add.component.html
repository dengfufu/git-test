<form nz-form [formGroup]="validateForm" (ngSubmit)="submitForm(validateForm.value)">
  <nz-spin [nzSpinning]="spinning">
    <nz-form-item>
      <nz-form-label [nzSpan]="4" nzRequired>指标名称</nz-form-label>
      <nz-form-control [nzSpan]="16" nzHasFeedback [nzErrorTip]="nameErrorTpl">
        <input nz-input formControlName="name" style="width: 400px;" placeholder="请输入指标名称"/>
        <ng-template #nameErrorTpl let-control>
          <ng-container *ngIf="control.hasError">
            {{control.errors?.explain}}
          </ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
    <div *ngFor="let item of scoreList;let index = index">
      <nz-form-item>
        <nz-form-label [nzSpan]="4" nzRequired>分数</nz-form-label>
        <nz-form-control [nzSpan]="2" nzHasFeedback [nzErrorTip]="scoreErrorTpl">
          <input formControlName="{{item.id}}" [(ngModel)]="item.score" maxlength="5" nz-input placeholder="分数" style="width: 100px;"
                 type="number"/>
          <ng-template #scoreErrorTpl let-control>
            <ng-container  *ngIf="control.hasError('required')">
              请输入分数!
            </ng-container>
            <ng-container *ngIf="control.hasError('maxlength')">
              不能超过5位数！
            </ng-container>
          </ng-template>
        </nz-form-control>
        <nz-form-label [nzSpan]="4" nzRequired>分值名称</nz-form-label>
        <nz-form-control [nzSpan]="5" nzHasFeedback [nzErrorTip]="scoreNameErrorTpl">
          <input [ngModelOptions]="{standalone: true}" [(ngModel)]="item.label" nz-input maxlength="100"
                 style="width: 150px;" placeholder="分值名称"/>
          <ng-template #scoreNameErrorTpl let-control>
            <ng-container  *ngIf="control.hasError('required')">
              请输入分值名称!
            </ng-container>
            <ng-container *ngIf="control.hasError('maxlength')">
              不能超过100位数！
            </ng-container>
          </ng-template>
        </nz-form-control>
        <button type="button" *ngIf="!item.canDelete" nz-button [nzType]="'primary'" (click)="addScoreItem()">
          <i nz-icon nzType="plus-circle"></i>
        </button>
        <button type="button" *ngIf="item.canDelete" nz-button [nzType]="'primary'"
                (click)="removeScoreItem(item,index)">
          <i nz-icon nzType="minus-circle" nzTheme="outline"></i>
        </button>
      </nz-form-item>
    </div>

    <nz-form-item>
      <nz-form-label [nzSpan]="4" nzRequired>显示样式</nz-form-label>
      <nz-form-control [nzSpan]="16" nzHasFeedback [nzErrorTip]="showTypeErrorTpl">
        <nz-select
          style="width: 400px;"
          nzShowSearch
          nzAllowClear
          nzPlaceHolder="请选择系统类型"
          formControlName="showType"
          [(ngModel)]="showTypeSelectValue">
          <nz-option *ngFor="let o of showTypeOptions" [nzLabel]="o.text" [nzValue]="o.value"></nz-option>
        </nz-select>
        <ng-template #showTypeErrorTpl let-control>
          <ng-container *ngIf="control.hasError('required')">
            请输入系统类型！
          </ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSpan]="4">指标描述</nz-form-label>
      <nz-form-control nzValidateStatus="false" [nzSpan]="16" nzHasFeedback [nzErrorTip]="descriptionErrorTpl">
        <textarea rows="4" placeholder="请输入指标描述" nz-input formControlName="description" style="width: 400px;"
                  maxlength="200"></textarea>
        <ng-template #descriptionErrorTpl let-control>
          <ng-container *ngIf="control.hasError('maxlength')">
            不能超过200个字符！
          </ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
    <text-area-word-number currentNumber="{{validateForm.value.description.length}}"
                           totalCount="200" ></text-area-word-number>
    <nz-form-item>
      <nz-form-label [nzSpan]="4">是否可用</nz-form-label>
      <nz-form-control [nzSpan]="16">
        <nz-switch formControlName="enabled" nzCheckedChildren="是" nzUnCheckedChildren="否"></nz-switch>
      </nz-form-control>
    </nz-form-item>
  </nz-spin>
</form>
<div *nzModalFooter>
  <button nz-button type="button" (click)="destroyModal()" class="button-modal-cancel">取消</button>
  <button nz-button nzType="primary"  (click)="submitForm(validateForm.value)"  [disabled]="!validateForm.valid"  class="button-modal-submit" >提交</button>
</div>
