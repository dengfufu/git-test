<form nz-form [formGroup]="validateForm" (ngSubmit)="submitForm(validateForm.value)">
  <nz-spin [nzSpinning]="spinning">
    <input nz-input hidden="true" formControlName="id">
    <nz-form-item>
      <nz-form-label [nzSpan]="4" nzRequired>委托商</nz-form-label>
      <nz-form-control [nzSpan]="16">
        <nz-select nzShowSearch formControlName="corp" style="width: 400px;" nzDisabled>
          <nz-option *ngFor="let demanderCorp of demanderCorpList" [nzValue]="demanderCorp.demanderCorp"
                     [nzLabel]="demanderCorp.demanderCorpName"></nz-option>
        </nz-select>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSpan]="4" nzRequired>设备大类</nz-form-label>
      <nz-form-control [nzSpan]="16" nzHasFeedback [nzErrorTip]="largeClassErrorTpl">
        <nz-select
          formControlName="largeClassId"
          nzShowSearch
          nzAllowClear
          style="width: 400px;"
          nzPlaceHolder="请选择设备大类">
          <nz-option *ngFor="let data of largeClassList" [nzLabel]="data.name" [nzValue]="data.id"></nz-option>
        </nz-select>
        <ng-template #largeClassErrorTpl let-control>
          <ng-container *ngIf="control.hasError('required')">
            请选择设备大类！
          </ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSpan]="4" nzRequired>设备类型名称</nz-form-label>
      <nz-form-control [nzSpan]="16" nzHasFeedback [nzErrorTip]="nameErrorTpl">
        <input nz-input formControlName="name"   style="width: 400px;" placeholder="请输入设备类型名称"/>
        <ng-template #nameErrorTpl let-control>
          <ng-container *ngIf="control.hasError">
            {{control.errors?.explain}}
          </ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSpan]="4">设备规格</nz-form-label>
      <nz-form-control [nzSpan]="16">
        <i nz-icon nzType="plus-circle" nzTheme="outline" style="color: #FF9F00;font-size: 18px;"
           (click)="addSpecification()"></i>
      </nz-form-control>
    </nz-form-item>
    <div nz-row>
      <nz-col [nzSpan]="4"></nz-col>
      <nz-col [nzSpan]="20">
        <nz-table nzShowSizeChanger
                  [nzBordered]="true"
                  [nzFrontPagination]="false"
                  [nzData]="deviceSpecificationList"
                  nzNoResult="无设备规格">
          <thead>
          <tr>
            <th nzWidth="50px">序号</th>
            <th>规格名称</th>
            <th nzWidth="80px">是否可用</th>
            <th nzWidth="100px">操作</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let deviceSpecification of deviceSpecificationList;let index = index">
            <td>{{index + 1}}</td>
            <td>{{deviceSpecification.name}}</td>
            <td>
              <span *ngIf="deviceSpecification.enabled === 'Y'">是</span>
              <span *ngIf="deviceSpecification.enabled !== 'Y'" style="color: red">否</span>
            </td>
            <td>
              <a (click)="modSpecification(deviceSpecification)">编辑</a>
              <nz-divider nzType="vertical"></nz-divider>
              <a (click)="showDeleteConfirm(deviceSpecification.id)">删除</a>
            </td>
          </tr>
          </tbody>
        </nz-table>
      </nz-col>
    </div>
    <nz-form-item>
      <nz-form-label [nzSpan]="4" nzRequired>顺序号</nz-form-label>
      <nz-form-control [nzSpan]="16" nzHasFeedback [nzErrorTip]="sortErrorTpl">
        <input nz-input formControlName="sortNo" style="width: 400px;" placeholder="请输入顺序号">
        <ng-template #sortErrorTpl let-control>
          <ng-container *ngIf="control.hasError('required')">
            请输入顺序号！
          </ng-container>
          <ng-container *ngIf="control.hasError('max')">
            顺序号过长！
          </ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSpan]="4">描述</nz-form-label>
      <nz-form-control  nzValidateStatus="false" [nzSpan]="16" nzHasFeedback [nzErrorTip]="descriptionErrorTpl">
        <textarea nz-input formControlName="description" maxlength="200" style="width: 400px;"
                  [nzAutosize]="{minRows: 2,maxRows: 5}"   placeholder="请输入描述"></textarea>
        <ng-template #descriptionErrorTpl let-control>
          <ng-container *ngIf="control.hasError('maxlength')">
            不能超过200个字符！
          </ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
    <text-area-word-number currentNumber="{{validateForm.value.description.length}}"
                           totalCount="200" ></text-area-word-number>
    <nz-form-item>
      <nz-form-label [nzSpan]="4">是否可用</nz-form-label>
      <nz-form-control [nzSpan]="16">
        <nz-switch formControlName="enabled" nzCheckedChildren="是" nzUnCheckedChildren="否"></nz-switch>
      </nz-form-control>
    </nz-form-item>
  </nz-spin>
</form>

<div *nzModalFooter>
  <button nz-button type="button" (click)="destroyModal()" class="button-modal-cancel">取消</button>
  <button nz-button nzType="primary"  (click)="submitForm(validateForm.value)"  [disabled]="!validateForm.valid"  class="button-modal-submit" >提交</button>
</div>

