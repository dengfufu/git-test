<nz-layout>
  <nz-content>
    <nz-card [nzBordered]="false">

      <div class="edit-button-div">
        <!--<i  nz-icon nzType="plus-circle" nzTheme="outline" class="icon-add" (click)="addDeviceModel()" nz-tooltip
            nzTooltipTitle="新建" [acl]="{ability: [aclRight.DEVICE_MODEL_ADD]}"></i>
        <i nz-icon nzType="anyfix:filtrate" nzTheme="outline" class="img-filtrate" (click)="openDrawer()" nz-tooltip
           nzTooltipTitle="筛选"></i>-->
        <button nz-button  class="icon-add" nzShape="round"  (click)="addDeviceModel()" [acl]="{ability: [aclRight.DEVICE_MODEL_ADD]}">新建</button>
        <button nz-button  class="img-filtrate" nzShape="round"  (click)="openDrawer()">筛选</button>
      </div>

      <nz-table #headerTable
                nzShowSizeChanger
                nzBordered
                [nzFrontPagination]="false"
                [nzData]="deviceModelList"
                [nzLoading]="loading"
                [nzTotal]="page.total"
                [(nzPageIndex)]="page.pageNum"
                [(nzPageSize)]="page.pageSize"
                (nzPageIndexChange)="queryDeviceModel()"
                (nzPageSizeChange)="queryDeviceModel(true)">
        <thead>
        <tr>
          <th nzWidth="50px">序号</th>
          <th>委托商</th>
          <th>设备型号</th>
          <th>设备品牌</th>
          <th>设备大类</th>
          <th>设备类型</th>
          <th nzWidth="100px">是否可用</th>
          <th nzWidth="100px" [acl]="{ability: [aclRight.DEVICE_MODEL_MOD, aclRight.DEVICE_MODEL_DEL]}">操作</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let data of headerTable.data;let index = index">
          <td>{{ page.getNo(index) }}</td>
          <td>{{ data.corpName }}</td>
          <td>{{ data.name }}</td>
          <td>{{ data.brandName }}</td>
          <td>{{ data.largeClassName }}</td>
          <td>{{ data.smallClassName }}</td>
          <td>
            <span *ngIf="data.enabled == 'Y'">是</span>
            <span *ngIf="data.enabled != 'Y'">否</span>
          </td>
          <td [acl]="{ability: [aclRight.DEVICE_MODEL_MOD, aclRight.DEVICE_MODEL_DEL]}">
            <a [acl]="{ability: [aclRight.DEVICE_MODEL_MOD]}" (click)="modDeviceModel(data)">编辑</a>
            <nz-divider [acl]="{ability: [aclRight.DEVICE_MODEL_MOD, aclRight.DEVICE_MODEL_DEL], mode: 'allOf'}"
                        nzType="vertical"></nz-divider>
            <a [acl]="{ability: [aclRight.DEVICE_MODEL_DEL]}" (click)="showDeleteConfirm(data.id)">删除</a>
          </td>
        </tr>
        </tbody>
      </nz-table>
    </nz-card>
    <nz-drawer nzTitle="设备型号筛选" [nzVisible]="drawerVisible" [nzClosable]="true" (nzOnClose)="closeDrawer()" nzWidth="350px">
      <form nz-form [nzLayout]="'inline'" [formGroup]="validateForm">
        <nz-form-item>
          <nz-form-label>委托商</nz-form-label>
          <nz-form-control>
            <nz-select nzShowSearch nzAllowClear formControlName="corp" nzPlaceHolder="请选择委托商" style="width: 250px;"
                       (ngModelChange)="demanderCorpChange($event)">
              <nz-option *ngFor="let demanderCorp of demanderCorpList" [nzValue]="demanderCorp.demanderCorp"
                         [nzLabel]="demanderCorp.demanderCorpName"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
        <nz-form-item>
          <nz-form-label>设备品牌</nz-form-label>
          <nz-form-control>
            <nz-select nzAllowClear style="width: 250px;" formControlName="brandId" nzPlaceHolder="请选择品牌">
              <nz-option *ngFor="let data of brandList" [nzLabel]="data.name" [nzValue]="data.id"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
        <nz-form-item>
          <nz-form-label>设备型号</nz-form-label>
          <nz-form-control>
            <input nz-input nzAllowClear style="width: 250px;" formControlName="name" placeholder="请输入型号名称"/>
          </nz-form-control>
        </nz-form-item>
        <nz-form-item>
          <nz-form-label>设备大类</nz-form-label>
          <nz-form-control>
            <nz-select (ngModelChange)="largeClassChange($event)" style="width: 250px;" formControlName="largeClassId"
                       nzAllowClear   nzPlaceHolder="请选择设备大类">
              <nz-option *ngFor="let data of largeClassList" [nzLabel]="data.name" [nzValue]="data.id"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
        <nz-form-item>
          <nz-form-label>设备类型</nz-form-label>
          <nz-form-control>
            <nz-select style="width: 250px;" formControlName="smallClassId" nzPlaceHolder="请选择设备类型">
              <nz-option *ngFor="let data of smallClassList" [nzLabel]="data.name" [nzValue]="data.id"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
        <nz-form-item>
          <nz-form-label>是否可用</nz-form-label>
          <nz-form-control>
            <nz-select nzAllowClear style="width: 250px;" formControlName="enabled" nzPlaceHolder="是/否">
              <nz-option nzLabel="是" nzValue="Y"></nz-option>
              <nz-option nzLabel="否" nzValue="N"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
        <div style="text-align: right;margin-top: 40px">
          <button class="ant-btn" style="margin-right: 10px" nz-button (click)="clearDrawer()">清空筛选</button>
          <button nz-button [nzType]="'primary'" (click)="useFormValue=true;closeDrawer();queryDeviceModel(true)">查询</button>
        </div>
      </form>
    </nz-drawer>
  </nz-content>
</nz-layout>
